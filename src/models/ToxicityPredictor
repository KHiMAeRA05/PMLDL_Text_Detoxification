import pandas as pd
from tqdm import tqdm
from transformers import AutoTokenizer, AutoModelForSequenceClassification, pipeline

class ToxicityPredictor:
    def __init__(self, model_name):
        self.tokenizer = AutoTokenizer.from_pretrained(model_name)
        self.model = AutoModelForSequenceClassification.from_pretrained(model_name)
        self.classifier = pipeline("text-classification", model=self.model, tokenizer=self.tokenizer)

    def predict(self, text):
        result = self.classifier(text)
        return result[0]['score']

# Usage example:
# predictor = ToxicityPredictor("facebook/roberta-hate-speech-dynabench-r4-target")
# prediction = predictor.predict("This is an example sentence.")
# print(prediction)
