import pandas as pd
from tqdm import tqdm
from transformers import AutoTokenizer, AutoModelForSequenceClassification, pipeline

class ToxicityPredictor:
    def __init__(self, model_name='SkolkovoInstitute/roberta_toxicity_classifier'):
        self.tokenizer = AutoTokenizer.from_pretrained(model_name)
        self.model = AutoModelForSequenceClassification.from_pretrained(model_name)
        self.classifier = pipeline("text-classification", model=self.model, tokenizer=self.tokenizer)

    def predict(self, text):
        result = self.classifier(text)
        score = result[0]['score']
        if result[0]['label'] == 'neutral':
            score = 1 - score
        return score

# Usage example:
# predictor = ToxicityPredictor("facebook/roberta-hate-speech-dynabench-r4-target")
# prediction = predictor.predict("This is an example sentence.")
# print(prediction)